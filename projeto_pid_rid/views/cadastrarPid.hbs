<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cria√ß√£o de PID</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>

<body>
    <div class="container mt-5">
        <div class="card shadow p-4 mx-auto">
            <h2 class="text-center mb-4">Cria√ß√£o de PID</h2>
            <form method="post" action="/projeto_pid_rid/newpid">
                <div class="row mb-3">
                    <div class="col-md-6">
                        <label for="ano" class="form-label">Ano Letivo</label>
                        <input type="number" class="form-control" id="ano" name="ano"
                            placeholder="Digite o ano letivo..." required />
                    </div>
                    <div class="col-md-6">
                        <label for="semestre" class="form-label">Semestre Letivo</label>
                        <select class="form-control" id="semestre" name="semestre" required>
                            <option value="">Selecione o semestre...</option>
                            <option value="1">1</option>
                            <option value="2">2</option>
                        </select>
                    </div>
                </div>

                <!-- Se√ß√µes de Atividades -->
                <div id="secoes-atividades">
                    <!-- Disciplinas -->
                    <div class="secao-atividade mb-4">
                        <h3>Disciplinas</h3>
                        <button type="button" class="btn btn-primary btn-sm" data-bs-toggle="modal"
                            data-bs-target="#modalDisciplinas">
                            + Adicionar Disciplina
                        </button>
                        <div id="lista-disciplinas" class="mt-2"></div>
                    </div>

                    <!-- Atividades de Prepara√ß√£o e Manuten√ß√£o do Ensino -->
                    <div class="secao-atividade mb-4">
                        <h3>Atividades de Prepara√ß√£o e Manuten√ß√£o do Ensino</h3>
                        <button type="button" class="btn btn-primary btn-sm"
                            onclick="abrirModalAtividades('preparacao-manutencao-ensino')">
                            + Adicionar Atividade
                        </button>
                        <div id="lista-preparacao-manutencao" class="mt-2"></div>
                    </div>

                    <!-- Atividades de Apoio ao Ensino -->
                    <div class="secao-atividade mb-4">
                        <h3>Atividades de Apoio ao Ensino</h3>
                        <button type="button" class="btn btn-primary btn-sm"
                            onclick="abrirModalAtividades('apoio-ensino')">
                            + Adicionar Atividade
                        </button>
                        <div id="lista-apoio-ensino" class="mt-2"></div>
                    </div>

                    <!-- Atividades de Orienta√ß√£o -->
                    <div class="secao-atividade mb-4">
                        <h3>Atividades de Orienta√ß√£o</h3>
                        <button type="button" class="btn btn-primary btn-sm"
                            onclick="abrirModalAtividades('orientacao')">
                            + Adicionar Atividade
                        </button>
                        <div id="lista-orientacao" class="mt-2"></div>
                    </div>

                    <!-- Atividades de Pesquisa e Inova√ß√£o -->
                    <div class="secao-atividade mb-4">
                        <h3>Atividades de Pesquisa e Inova√ß√£o</h3>
                        <button type="button" class="btn btn-primary btn-sm"
                            onclick="abrirModalAtividades('pesquisa-inovacao')">
                            + Adicionar Atividade
                        </button>
                        <div id="lista-pesquisa-inovacao" class="mt-2"></div>
                    </div>

                    <!-- Atividades de Extens√£o -->
                    <div class="secao-atividade mb-4">
                        <h3>Atividades de Extens√£o</h3>
                        <button type="button" class="btn btn-primary btn-sm" onclick="abrirModalAtividades('extensao')">
                            + Adicionar Atividade
                        </button>
                        <div id="lista-extensao" class="mt-2"></div>
                    </div>

                    <!-- Atividades de Gest√£o Institucional e Representa√ß√µes -->
                    <div class="secao-atividade mb-4">
                        <h3>Atividades de Gest√£o Institucional e Representa√ß√µes</h3>
                        <button type="button" class="btn btn-primary btn-sm"
                            onclick="abrirModalAtividades('gestao-institucional')">
                            + Adicionar Atividade
                        </button>
                        <div id="lista-gestao-institucional" class="mt-2"></div>
                    </div>

                    <!-- Atividades de Qualifica√ß√£o e Capacita√ß√£o -->
                    <div class="secao-atividade mb-4">
                        <h3>Atividades de Qualifica√ß√£o e Capacita√ß√£o</h3>
                        <button type="button" class="btn btn-primary btn-sm"
                            onclick="abrirModalAtividades('qualificacao-capacitacao')">
                            + Adicionar Atividade
                        </button>
                        <div id="lista-qualificacao-capacitacao" class="mt-2"></div>
                    </div>

                    <!-- Nova Se√ß√£o de Observa√ß√£o -->
                    <div class="secao-atividade mb-4">
                        <h3>Observa√ß√£o</h3>
                        <button type="button" class="btn btn-warning btn-sm" data-bs-toggle="modal"
                            data-bs-target="#modalObservacao">
                            + Adicionar Observa√ß√£o
                        </button>
                        <div id="exibir-observacao" class="mt-2"></div>
                    </div>

                </div>

                <div class="text-center">
                    <button type="submit" class="btn btn-primary">Enviar</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal para Adicionar Disciplinas -->
    <div class="modal fade" id="modalDisciplinas" tabindex="-1" aria-labelledby="modalDisciplinasLabel"
        aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="modalDisciplinasLabel">Adicionar Disciplina</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="formDisciplina">
                        <div class="mb-3">
                            <label for="nomeDisciplina" class="form-label">Nome da Disciplina</label>
                            <input type="text" class="form-control" id="nomeDisciplina" required />
                        </div>
                        <div class="mb-3">
                            <label for="cargaHorariaDisciplina" class="form-label">Carga Hor√°ria</label>
                            <input type="number" class="form-control" id="cargaHorariaDisciplina" required />
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Fechar</button>
                    <button type="button" class="btn btn-primary" onclick="adicionarDisciplina()">Adicionar</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal para Adicionar Outras Atividades -->
    <div class="modal fade" id="modalAtividades" tabindex="-1" aria-labelledby="modalAtividadesLabel"
        aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="modalAtividadesLabel">Adicionar Atividade</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="formAtividade">
                        <div class="mb-3">
                            <label for="tipoAtividade" class="form-label">Tipo de Atividade</label>
                            <select class="form-control" id="tipoAtividade" required>
                                <!-- Op√ß√µes ser√£o preenchidas dinamicamente -->
                            </select>
                        </div>
                        <div class="mb-3">
                            <label for="cargaHorariaAtividade" class="form-label">Carga Hor√°ria</label>
                            <input type="number" class="form-control" id="cargaHorariaAtividade" required />
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Fechar</button>
                    <button type="button" class="btn btn-primary" onclick="adicionarAtividade()">Adicionar</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal para Observa√ß√£o -->
    <div class="modal fade" id="modalObservacao" tabindex="-1" aria-labelledby="modalObservacaoLabel"
        aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="modalObservacaoLabel">Adicionar Observa√ß√£o</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="formObservacao">
                        <div class="mb-3">
                            <label for="textoObservacao" class="form-label">Digite sua observa√ß√£o</label>
                            <textarea class="form-control" id="textoObservacao" rows="4" required></textarea>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Fechar</button>
                    <button type="button" class="btn btn-primary" onclick="adicionarObservacao()">Salvar</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap JS e Depend√™ncias -->
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.min.js"></script>

    <script>
        // Dados das atividades por tipo
        const atividadesPorTipo = {
            'preparacao-manutencao-ensino': [
                'Estudo, Planejamento e Elabora√ß√£o de Materiais e Pr√°ticas Pedag√≥gicas',
                'Prepara√ß√£o de Aulas Te√≥ricas e Pr√°ticas',
                'Organiza√ß√£o de Material Pedag√≥gico',
                'Produ√ß√£o e Corre√ß√£o dos Instrumentos de Avalia√ß√£o',
                'Registro de Atividades Acad√™micas'
            ],
            'apoio-ensino': [
                'Atendimento de Alunos Extraclasse (f√≠sica ou virtual)',
                'Reuni√µes Pedag√≥gicas, Conselhos de Classe e/ou Reuni√µes de Pais',
                'Participa√ß√£o Banca de Trabalho de Conclus√£o de Curso',
                'Atendimento de Alunos em Regime de Exerc√≠cio Domiciliar',
                'Orienta√ß√£o em Ol√≠mpiadas do Conhecimento e/ou Competi√ß√µes Diversas',
                'Organiza√ß√£o, Coordena√ß√£o e/ou Acompanhamento de Visitas T√©cnicas',
                'Nivelamento sem Constitui√ß√£o de Turma'
            ],
            'orientacao': [
                'Orienta√ß√£o de Est√°gio',
                'Coordena√ß√£o e Participa√ß√£o como Colaborador em Projeto de Ensino',
                'Orienta√ß√£o Acad√™mica',
                'Orienta√ß√£o em Monitorias de Ensino e Inicia√ß√£o √† Doc√™ncia',
                'Orienta√ß√£o de Trabalhos de Conclus√£o de Curso',
                'Orienta√ß√£o ou Coorienta√ß√£o de Mestrado ou Doutorado',
                'Participa√ß√£o na Elabora√ß√£o e Revis√£o de Projetos Pedag√≥gicos de Cursos'
            ],
            'pesquisa-inovacao': [
                'Atividades de Pesquisa e Inova√ß√£o',
                'Coordena√ß√£o e Participa√ß√£o como colaborador em Projeto de Pesquisa',
                'Orienta√ß√£o de Aluno de Inicia√ß√£o √† Pesquisa Cient√≠fica e/ou Tecnol√≥gica',
                'Coordena√ß√£o e/ou Participa√ß√£o de Grupo de Pesquisa Cadastrado no CNPq',
                'Participa√ß√£o de Banca Examinadora de Tese de Doutorado e/ou Disserta√ß√£o de Mestrado',
                'Participa√ß√£o em Conselho Editorial Local, Regional, Nacional ou Internacional'
            ],
            'extensao': [
                'Coordena√ß√£o e Participa√ß√£o como Colaborador em Programas e Projetos de Extens√£o',
                'Coordena√ß√£o de Cursos e Eventos de Extens√£o',
                'Publica√ß√£o de P√¥sters, Resumos e/ou artigos Resultantes de Projetos de Extens√£o, em Peri√≥dicos de Extens√£o',
                'Presta√ß√£o de Servi√ßos: Conjunto de A√ß√µes, tais como Consultorias, Laudos T√©cnicos e Assessorias',
                'Atividades Resultantes de Projetos e Programas de Extens√£o, Tais como Apresenta√ß√µes em Eventos'
            ],
            'gestao-institucional': [
                'Diretorias Sist√™micas, Chefias e Coordenadorias de Ensino, Pesquisa e Extens√£o',
                'Atividades de Coordena√ß√£o de Curso',
                'Atividades de Chefia ou Coordena√ß√£o de Laborat√≥rio de Pesquisa',
                'Atividades Referentes aos Processos de Cota√ß√£o, Compra, Confer√™ncia de Materiais',
                'Atividades n√£o Remuneradas de Participa√ß√£o em Comiss√µes Permanentes'
            ],
            'qualificacao-capacitacao': [
                'Curso de Gradua√ß√£o',
                'Curso de P√≥s-Gradua√ß√£o',
                'Curso de Mestrado',
                'Curso de Doutorado',
                'Curso de Capacita√ß√£o'
            ]
        };

        // Vari√°vel global para armazenar o tipo de atividade selecionado
        let tipoAtividadeSelecionado = '';

        // Fun√ß√£o para abrir o modal de atividades
        function abrirModalAtividades(tipo) {
            tipoAtividadeSelecionado = tipo;
            const modal = new bootstrap.Modal(document.getElementById('modalAtividades'));
            const select = document.getElementById('tipoAtividade');

            // Limpa as op√ß√µes anteriores
            select.innerHTML = '';

            // Adiciona as op√ß√µes correspondentes ao tipo de atividade
            atividadesPorTipo[tipo].forEach(atividade => {
                const option = document.createElement('option');
                option.value = atividade;
                option.textContent = atividade;
                select.appendChild(option);
            });

            // Abre o modal
            modal.show();
        }

        function adicionarDisciplina() {
            const nome = document.getElementById('nomeDisciplina').value;
            const cargaHoraria = document.getElementById('cargaHorariaDisciplina').value;

            if (!nome || !cargaHoraria) {
                alert("Por favor, preencha todos os campos.");
                return;
            }

            const listaDisciplinas = document.getElementById('lista-disciplinas');
            listaDisciplinas.innerHTML += `
        <div class="card mb-2">
            <div class="card-body">
                <h5 class="card-title">${nome}</h5>
                <p class="card-text">Carga Hor√°ria: ${cargaHoraria} horas</p>
            </div>
        </div>
    `;

            // Fechar o modal corretamente
            const modalElement = document.getElementById('modalDisciplinas');
            const modal = bootstrap.Modal.getInstance(modalElement) || new bootstrap.Modal(modalElement);
            modal.hide();

            // üî• Remover manualmente o backdrop caso ele continue na tela
            setTimeout(() => {
                document.querySelectorAll('.modal-backdrop').forEach(el => el.remove());
            }, 500);

            // Limpar os campos do modal
            document.getElementById('nomeDisciplina').value = '';
            document.getElementById('cargaHorariaDisciplina').value = '';
        }


        function adicionarDisciplina() {
    const nome = document.getElementById('nomeDisciplina').value;
    const cargaHoraria = document.getElementById('cargaHorariaDisciplina').value;

    if (!nome || !cargaHoraria) {
        alert("Por favor, preencha todos os campos.");
        return;
    }

    const listaDisciplinas = document.getElementById('lista-disciplinas');
    listaDisciplinas.innerHTML += `
        <div class="card mb-2">
            <div class="card-body">
                <h5 class="card-title">${nome}</h5>
                <p class="card-text">Carga Hor√°ria: ${cargaHoraria} horas</p>
            </div>
        </div>
    `;

    // Fechar modal corretamente
    const modalElement = document.getElementById('modalDisciplinas');
    const modal = bootstrap.Modal.getInstance(modalElement) || new bootstrap.Modal(modalElement);
    modal.hide();

    // üî• Remover backdrop manualmente e garantir reabertura do modal
    setTimeout(() => {
        document.querySelectorAll('.modal-backdrop').forEach(el => el.remove());
        document.body.classList.remove('modal-open'); // Garante que a p√°gina n√£o fique travada
        modalElement.classList.remove('show'); // Remove classe show para evitar inconsist√™ncias
        modalElement.style.display = 'none'; // Garante que o modal desapare√ßa
    }, 300);

    // Limpar os campos do modal
    document.getElementById('nomeDisciplina').value = '';
    document.getElementById('cargaHorariaDisciplina').value = '';

    // üîÑ Resetar modal para que ele possa ser reaberto corretamente
    modalElement.addEventListener('hidden.bs.modal', function () {
        modalElement.removeAttribute('aria-modal');
        modalElement.setAttribute('aria-hidden', 'true');
    }, { once: true });
}


        function adicionarObservacao() {
            const observacao = document.getElementById('textoObservacao').value;

            if (!observacao.trim()) {
                alert("Por favor, escreva uma observa√ß√£o antes de salvar.");
                return;
            }

            const exibirObservacao = document.getElementById('exibir-observacao');
            exibirObservacao.innerHTML = `
                <div class="card mb-2">
                    <div class="card-body">
                        <p class="card-text">${observacao}</p>
                    </div>
                </div>
            `;

            const modal = bootstrap.Modal.getInstance(document.getElementById('modalObservacao'));
            modal.hide();
            document.getElementById('textoObservacao').value = '';
        }
    </script>
</body>

</html>